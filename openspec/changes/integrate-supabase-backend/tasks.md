# Tasks: é›†æˆ Supabase åç«¯æœåŠ¡ï¼ˆæ¨¡å—åŒ–å®æ–½ï¼‰

## ğŸ“¦ æ¨¡å—å®æ–½é¡ºåº

### Phase 1: æ ¸å¿ƒæ¨¡å—ï¼ˆå¿…é¡»ï¼‰

#### æ¨¡å— 1: åŸºç¡€è®¾æ–½æ¨¡å—

1. **åˆ›å»º Supabase é¡¹ç›®**
   - [ ] åœ¨ Supabase æ§åˆ¶å°åˆ›å»ºæ–°é¡¹ç›®
   - [ ] è®°å½•é¡¹ç›® URL å’Œ API Key
   - [ ] é…ç½®ç¯å¢ƒå˜é‡
   - [ ] é…ç½®é‚®ä»¶æ¨¡æ¿ï¼ˆAuthentication â†’ Email Templatesï¼‰
     - [ ] é…ç½®éªŒè¯ç é‚®ä»¶æ¨¡æ¿ï¼ˆç”¨äºæ‰¾å›è´¦å·ï¼‰ï¼Œä½¿ç”¨ `{{ .Token }}` æ˜¾ç¤ºéªŒè¯ç 
     - [ ] æµ‹è¯•é‚®ä»¶å‘é€åŠŸèƒ½
     - [ ] æ³¨æ„ï¼šæ³¨å†Œæ—¶ä¸éœ€è¦é‚®ä»¶éªŒè¯ï¼Œé‚®ç®±ä»…ç”¨äºæ‰¾å›è´¦å·

2. **å®‰è£…ä¾èµ–**
   - [x] å®‰è£… `@supabase/supabase-js` åŒ…

3. **åˆ›å»º Supabase å®¢æˆ·ç«¯**
   - [x] åˆ›å»º `src/services/supabase/client.ts`
   - [x] åˆå§‹åŒ– Supabase å®¢æˆ·ç«¯
   - [x] é…ç½®ç¯å¢ƒå˜é‡è¯»å–
   - [x] å¯¼å‡ºå®¢æˆ·ç«¯å•ä¾‹

4. **é…ç½®ç¯å¢ƒå˜é‡**
   - [x] åˆ›å»º `.env.example` æ–‡ä»¶
   - [x] åˆ›å»º `.env.local` æ–‡ä»¶ï¼ˆä¸æäº¤åˆ° Gitï¼‰
   - [x] åœ¨ `.gitignore` ä¸­æ·»åŠ  `.env.local`
   - [x] åœ¨ `vite.config.ts` ä¸­é…ç½®ç¯å¢ƒå˜é‡

5. **åˆ›å»ºè®¤è¯æœåŠ¡**
   - [x] åˆ›å»º `src/services/auth/auth.types.ts`ï¼ˆç±»å‹å®šä¹‰ï¼‰
   - [x] åˆ›å»º `src/services/auth/auth.service.ts`
   - [x] å®ç° `validateAccountName(accountName)` æ–¹æ³•ï¼ˆéªŒè¯è´¦æˆ·åæ ¼å¼ï¼šåªèƒ½å°å†™å­—æ¯å’Œæ•°å­—ï¼‰
   - [x] å®ç° `checkAccountNameExists(accountName)` æ–¹æ³•ï¼ˆæ£€æŸ¥è´¦æˆ·åæ˜¯å¦å·²è¢«ä½¿ç”¨ï¼‰
   - [x] å®ç° `signUp(accountName, nickname, email, password, role?)` æ–¹æ³•ï¼ˆè´¦æˆ·åå¯†ç æ³¨å†Œï¼Œæ”¯æŒ parent/studentï¼Œstudent éœ€ç”Ÿæˆé‚€è¯·ç ï¼‰
   - [x] å®ç° `getEmailByAccountName(accountName)` æ–¹æ³•ï¼ˆé€šè¿‡è´¦æˆ·åæŸ¥è¯¢é‚®ç®±ï¼‰
   - [x] å®ç° `signIn(accountName, password)` æ–¹æ³•ï¼ˆè´¦æˆ·åå¯†ç ç™»å½•ï¼‰
   - [x] å®ç° `signOut()` æ–¹æ³•
   - [x] å®ç° `getSession()` æ–¹æ³•
   - [x] å®ç° `sendRecoveryOtp(email)` æ–¹æ³•ï¼ˆå‘é€æ‰¾å›è´¦å·éªŒè¯ç ï¼‰
   - [x] å®ç° `verifyRecoveryOtp(email, token)` æ–¹æ³•ï¼ˆéªŒè¯æ‰¾å›è´¦å·éªŒè¯ç å¹¶ç™»å½•ï¼‰

6. **é›†æˆè®¤è¯çŠ¶æ€ç›‘å¬**
   - [x] åœ¨ `src/main.ts` ä¸­åˆå§‹åŒ–è®¤è¯ç›‘å¬
   - [x] åˆ›å»ºå…¨å±€è®¤è¯çŠ¶æ€ç®¡ç†
   - [x] å¤„ç†ç™»å½•/ç™»å‡ºäº‹ä»¶

7. **åˆ›å»ºç™»å½•/æ³¨å†Œé¡µé¢**
   - [x] åˆ›å»ºç™»å½•é¡µé¢ç»„ä»¶
     - [x] è´¦æˆ·åè¾“å…¥æ¡†ï¼ˆæç¤ºï¼šåªèƒ½åŒ…å«å°å†™å­—æ¯å’Œæ•°å­—ï¼‰
     - [x] å¯†ç è¾“å…¥æ¡†
     - [x] "å¿˜è®°å¯†ç "é“¾æ¥ï¼ˆè·³è½¬åˆ°æ‰¾å›è´¦å·é¡µé¢ï¼‰
     - [x] ç™»å½•æŒ‰é’®
   - [x] åˆ›å»ºæ³¨å†Œé¡µé¢ç»„ä»¶
     - [x] è´¦æˆ·åè¾“å…¥æ¡†ï¼ˆå¿…å¡«ï¼Œå®æ—¶éªŒè¯æ ¼å¼å’Œå”¯ä¸€æ€§ï¼‰
       - [x] æ ¼å¼æç¤ºï¼šåªèƒ½åŒ…å«å°å†™å­—æ¯å’Œæ•°å­—
       - [x] å®æ—¶æ£€æŸ¥è´¦æˆ·åæ˜¯å¦å·²è¢«ä½¿ç”¨
     - [x] æ˜µç§°è¾“å…¥æ¡†ï¼ˆå¿…å¡«ï¼Œç”¨äºæ˜¾ç¤ºï¼‰
     - [x] é‚®ç®±è¾“å…¥æ¡†ï¼ˆå¿…å¡«ï¼Œæç¤ºï¼šé‚®ç®±ä»…ç”¨äºæ‰¾å›è´¦å·ï¼‰
     - [x] å¯†ç è¾“å…¥æ¡†ï¼ˆå¿…å¡«ï¼‰
     - [x] è§’è‰²é€‰æ‹©ï¼ˆé»˜è®¤ studentï¼Œå¯é€‰ parentï¼‰
     - [x] æ³¨å†ŒæŒ‰é’®
   - [x] åˆ›å»ºæ‰¾å›è´¦å·é¡µé¢ç»„ä»¶
     - [x] é‚®ç®±è¾“å…¥æ¡†
     - [x] "å‘é€éªŒè¯ç "æŒ‰é’®
     - [x] éªŒè¯ç è¾“å…¥æ¡†
     - [x] "ç™»å½•"æŒ‰é’®
     - [x] "é‡æ–°å‘é€éªŒè¯ç "æŒ‰é’®
   - [x] å­¦ç”Ÿç«¯â€œæˆ‘çš„å®¶é•¿â€é¡µé¢
     - [x] å±•ç¤ºé‚€è¯·ç 
     - [x] å±•ç¤ºå·²ç»‘å®šå®¶é•¿åˆ—è¡¨ï¼ˆåªè¯»ï¼‰
   - [x] å®¶é•¿ç«¯â€œç®¡ç†å­¦ç”Ÿâ€é¡µé¢
     - [x] é€šè¿‡é‚€è¯·ç ç»‘å®šå­¦ç”Ÿï¼ˆå ä½ç•Œé¢ï¼Œåç»­æ¥ APIï¼‰
     - [x] é€šè¿‡å­¦ç”Ÿè´¦æˆ·åç»‘å®šå­¦ç”Ÿï¼ˆå ä½ç•Œé¢ï¼Œåç»­æ¥ APIï¼‰
     - [x] æŸ¥çœ‹å·²ç»‘å®šå­¦ç”Ÿåˆ—è¡¨ï¼ˆåªè¯»å ä½ï¼‰
     - [x] æŸ¥çœ‹å­¦ç”Ÿè¿›åº¦ã€ç»ƒä¹ ã€æ¸¸æˆè®°å½•ï¼ˆåªè¯»å ä½ï¼‰
     - [x] è§£é™¤ç»‘å®šï¼ˆå ä½æŒ‰é’®ï¼‰
  - [x] æ·»åŠ è¡¨å•éªŒè¯
    - [x] è´¦æˆ·åæ ¼å¼éªŒè¯ï¼ˆæ­£åˆ™ï¼š`^[a-z0-9]+$`ï¼‰
    - [x] è´¦æˆ·åå”¯ä¸€æ€§éªŒè¯ï¼ˆè°ƒç”¨ API æ£€æŸ¥ï¼‰
    - [x] é‚®ç®±æ ¼å¼éªŒè¯
    - [x] å¯†ç å¼ºåº¦éªŒè¯
  - [x] é›†æˆè®¤è¯æœåŠ¡
  - [x] æ·»åŠ è·¯ç”±ä¿æŠ¤

---

#### æ¨¡å— 2: ç”¨æˆ·æ¨¡å—

8. **åˆ›å»ºç”¨æˆ·æ¨¡å—æ•°æ®åº“è¡¨**
   - [x] åˆ›å»º `user_profiles` è¡¨ï¼ˆåŒ…å« `account_name`ã€`nickname`ã€`email`ã€`role`ã€`membership_tier`ã€`membership_expires_at`ã€`level`ã€`invite_code`ï¼‰
   - [x] åˆ›å»º `user_progress` è¡¨
   - [x] åˆ›å»ºç´¢å¼•ï¼ˆ`account_name` å”¯ä¸€ï¼›`email` ç´¢å¼•ï¼›`role` ç´¢å¼•ï¼›`membership_tier` ç´¢å¼•ï¼›`invite_code` å”¯ä¸€ï¼‰
   - [x] åˆ›å»ºè§¦å‘å™¨

9. **é…ç½®ç”¨æˆ·æ¨¡å— RLS**
   - [x] ä¸º `user_profiles` è¡¨å¯ç”¨ RLS
   - [x] ä¸º `user_progress` è¡¨å¯ç”¨ RLS
   - [x] åˆ›å»º RLS ç­–ç•¥

10. **åˆ›å»ºç”¨æˆ·æ¨¡å— API æœåŠ¡**
    - [x] åˆ›å»º `src/services/api/user.api.ts`
    - [x] å®ç° `checkAccountNameExists(accountName)` æ–¹æ³•ï¼ˆæ£€æŸ¥è´¦æˆ·åæ˜¯å¦å·²è¢«ä½¿ç”¨ï¼‰
    - [x] å®ç° `getInviteCode(userId)` æ–¹æ³•ï¼ˆå­¦ç”Ÿè·å–è‡ªå·±çš„é‚€è¯·ç ï¼‰
    - [x] å®ç° `getBoundParents(userId)` æ–¹æ³•ï¼ˆå­¦ç”ŸæŸ¥çœ‹å·²ç»‘å®šçš„å®¶é•¿ï¼Œåªè¯»ï¼‰
    - [x] å®ç° `getUserMembership(userId)` æ–¹æ³•ï¼ˆè¿”å› tier/expire/levelï¼‰
    - [x] å®ç° `updateMembership(userId, tier, expiresAt)` æ–¹æ³•
    - [x] å®ç° `updateUserLevel(userId, level)` æ–¹æ³•ï¼ˆç”±ç§¯åˆ†/è¿›åº¦è®¡ç®—åå›å†™ï¼‰
    - [x] å®ç° `getUserProfile()` æ–¹æ³•
    - [x] å®ç° `updateUserProfile()` æ–¹æ³•
    - [x] å®ç° `getUserProgress()` æ–¹æ³•
    - [x] å®ç° `updateUserProgress()` æ–¹æ³•

11. **ä¿®æ”¹ user.ts Store**
    - [x] æ·»åŠ è®¤è¯çŠ¶æ€ç®¡ç†
    - [x] é›†æˆäº‘ç«¯åŒæ­¥
    - [x] ä¿æŒå‘åå…¼å®¹ï¼ˆæ”¯æŒç¦»çº¿æ¨¡å¼ï¼‰

---

#### æ¨¡å— 3: ç»ƒä¹ æ¨¡å—

12. **åˆ›å»ºç»ƒä¹ æ¨¡å—æ•°æ®åº“è¡¨**
    - [x] åˆ›å»º `exercise_records` è¡¨
    - [x] åˆ›å»º `letter_stats` è¡¨
    - [x] åˆ›å»ºç´¢å¼•

13. **é…ç½®ç»ƒä¹ æ¨¡å— RLS**
    - [x] ä¸º `exercise_records` è¡¨å¯ç”¨ RLS
    - [x] ä¸º `letter_stats` è¡¨å¯ç”¨ RLS
    - [x] åˆ›å»º RLS ç­–ç•¥

14. **åˆ›å»ºç»ƒä¹ æ¨¡å— API æœåŠ¡**
    - [x] åˆ›å»º `src/services/api/exercise.api.ts`
    - [x] å®ç° `saveExerciseRecord()` æ–¹æ³•
    - [x] å®ç° `getExerciseRecords()` æ–¹æ³•
    - [x] å®ç° `batchUpdateLetterStats()` æ–¹æ³•
    - [x] å®ç° `getLetterStats()` æ–¹æ³•

15. **ä¿®æ”¹ exercise.ts Store**
    - [x] é›†æˆç»ƒä¹ è®°å½•åŒæ­¥
    - [x] æ”¯æŒç¦»çº¿æ¨¡å¼
    - [x] æ·»åŠ åŒæ­¥æ–¹æ³•

---

### Phase 2: æ‰©å±•æ¨¡å—ï¼ˆé‡è¦ï¼‰

#### æ¨¡å— 4: æ¸¸æˆæ¨¡å—

16. **åˆ›å»ºæ¸¸æˆæ¨¡å—æ•°æ®åº“è¡¨**
    - [x] åˆ›å»º `game_types` è¡¨ï¼ˆæ¸¸æˆå®šä¹‰ï¼šmembership/level/is_active/sort_orderï¼‰
    - [x] åˆ›å»º `game_records` è¡¨
    - [x] åˆ›å»ºç´¢å¼•

17. **é…ç½®æ¸¸æˆæ¨¡å— RLS**
    - [x] ä¸º `game_records` è¡¨å¯ç”¨ RLS
    - [x] åˆ›å»º RLS ç­–ç•¥
    - [x] `game_types` è¡¨è®¾ä¸ºå…¨å±€åªè¯»ï¼ˆå¯é€‰æ‹©ä¸å¼€å¯ RLS æˆ–åˆ›å»ºåªè¯»ç­–ç•¥ï¼‰

18. **åˆ›å»ºæ¸¸æˆæ¨¡å— API æœåŠ¡**
    - [x] åˆ›å»º `src/services/api/game.api.ts`
    - [x] å®ç° `saveGameRecord()` æ–¹æ³•
    - [x] å®ç° `getGameRecord()` æ–¹æ³•
    - [x] å®ç° `getGameRecords()` æ–¹æ³•
    - [x] å®ç° `getAvailableGames(userId)` æ–¹æ³•ï¼ˆæŒ‰ä¼šå‘˜/ç­‰çº§è¿‡æ»¤ game_typesï¼‰
    - [x] å®ç°åå°/é…ç½®çš„ `upsertGameType()` æ–¹æ³•ï¼ˆå¯é€‰ï¼Œç”¨äºæ–°å¢/ä¸‹æ¶æ¸¸æˆï¼‰
    - [x] å®ç° `getAvailablePlayMinutes(userId, date)`ï¼ˆè®¡ç®—å½“æ—¥å¯ç”¨æ¸¸æˆæ—¶é•¿ï¼‰
    - [x] åœ¨å¼€å§‹æ¸¸æˆæ—¶æ ¡éªŒï¼š
      - å®¶é•¿æˆ– premiumï¼šè·³è¿‡æ ¡éªŒ
      - å…¶ä»–ç”¨æˆ·ï¼šéœ€å½“æ—¥ç»ƒä¹ å·²å®Œæˆä¸”å¯ç”¨æ—¶é•¿>0ï¼›å•æ¬¡ä¼šè¯ä¸Šé™ 30 åˆ†é’Ÿ

19. **ä¿®æ”¹ game.ts Store**
    - [x] é›†æˆæ¸¸æˆè®°å½•åŒæ­¥
    - [x] æ”¯æŒç¦»çº¿æ¨¡å¼
    - [x] æ·»åŠ åŒæ­¥æ–¹æ³•

---

#### æ¨¡å— 5: ç§¯åˆ†æ¨¡å—

20. **åˆ›å»ºç§¯åˆ†æ¨¡å—æ•°æ®åº“è¡¨**
    - [x] åˆ›å»º `points_transactions` è¡¨
    - [x] åˆ›å»ºç´¢å¼•

21. **é…ç½®ç§¯åˆ†æ¨¡å— RLS**
    - [x] ä¸º `points_transactions` è¡¨å¯ç”¨ RLS
    - [x] åˆ›å»º RLS ç­–ç•¥ï¼ˆåªè¯»ï¼‰

22. **åˆ›å»ºç§¯åˆ†æ¨¡å— API æœåŠ¡**
    - [x] åˆ›å»º `src/services/api/points.api.ts`
    - [x] å®ç° `getUserPoints()` æ–¹æ³•
    - [x] å®ç° `addPoints()` æ–¹æ³•
    - [x] å®ç° `deductPoints()` æ–¹æ³•
    - [x] å®ç° `getPointsHistory()` æ–¹æ³•

23. **é›†æˆç§¯åˆ†æ¨¡å—åˆ° user.ts Store**
    - [x] æ·»åŠ ç§¯åˆ†ç®¡ç†æ–¹æ³•
    - [x] é›†æˆç§¯åˆ†äº¤æ˜“è®°å½•

---

#### æ¨¡å— 6: ç¤¼ç‰©æ¨¡å—

24. **åˆ›å»ºç¤¼ç‰©æ¨¡å—æ•°æ®åº“è¡¨**
    - [x] åˆ›å»º `gifts` è¡¨ï¼ˆç³»ç»Ÿè¡¨ï¼‰
    - [x] åˆ›å»º `redeemed_gifts` è¡¨
    - [x] åˆ›å»ºç´¢å¼•

25. **é…ç½®ç¤¼ç‰©æ¨¡å— RLS**
    - [x] ä¸º `gifts` è¡¨å¯ç”¨ RLSï¼ˆæ‰€æœ‰ç”¨æˆ·å¯è¯»ï¼‰
    - [x] ä¸º `redeemed_gifts` è¡¨å¯ç”¨ RLS
    - [x] åˆ›å»º RLS ç­–ç•¥

26. **åˆ›å»ºç¤¼ç‰©æ¨¡å— API æœåŠ¡**
    - [x] åˆ›å»º `src/services/api/gift.api.ts`
    - [x] å®ç° `getAvailableGifts()` æ–¹æ³•
    - [x] å®ç° `getGiftById()` æ–¹æ³•
    - [x] å®ç° `redeemGift()` æ–¹æ³•
    - [x] å®ç° `getRedeemedGifts()` æ–¹æ³•

27. **é›†æˆç¤¼ç‰©æ¨¡å—åˆ° user.ts Store**
    - [x] æ·»åŠ ç¤¼ç‰©ç®¡ç†æ–¹æ³•
    - [x] é›†æˆå…‘æ¢åŠŸèƒ½

---

#### æ¨¡å— 7: æˆå°±æ¨¡å—

28. **åˆ›å»ºæˆå°±æ¨¡å—æ•°æ®åº“è¡¨**
    - [x] åˆ›å»º `achievements` è¡¨
    - [x] åˆ›å»ºç´¢å¼•

29. **é…ç½®æˆå°±æ¨¡å— RLS**
    - [x] ä¸º `achievements` è¡¨å¯ç”¨ RLS
    - [x] åˆ›å»º RLS ç­–ç•¥

30. **åˆ›å»ºæˆå°±æ¨¡å— API æœåŠ¡**
    - [x] åˆ›å»º `src/services/api/achievement.api.ts`
    - [x] å®ç° `unlockAchievement()` æ–¹æ³•
    - [x] å®ç° `getUserAchievements()` æ–¹æ³•
    - [x] å®ç° `isAchievementUnlocked()` æ–¹æ³•

31. **é›†æˆæˆå°±æ¨¡å—åˆ° user.ts Store**
    - [x] æ·»åŠ æˆå°±ç®¡ç†æ–¹æ³•
    - [x] é›†æˆæˆå°±è§£é”åŠŸèƒ½

---

### Phase 3: é«˜çº§åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰

#### æ¨¡å— 8: å®¶é•¿æ¨¡å—

32. **æ‰©å±•ç”¨æˆ·æ¨¡å—è¡¨ç»“æ„**
    - [x] åœ¨ `user_profiles` è¡¨æ·»åŠ  `role` å­—æ®µ
    - [x] åˆ›å»º `parent_student_relations` è¡¨
    - [x] åˆ›å»ºç´¢å¼•

33. **é…ç½®å®¶é•¿æ¨¡å— RLS**
    - [x] ä¸º `parent_student_relations` è¡¨å¯ç”¨ RLS
    - [x] åˆ›å»º RLS ç­–ç•¥ï¼ˆå®¶é•¿å¯æŸ¥çœ‹å­¦ç”Ÿæ•°æ®ï¼‰

34. **åˆ›å»ºå®¶é•¿æ¨¡å— API æœåŠ¡**
    - [ ] åˆ›å»º `src/services/api/parent.api.ts`
    - [ ] å®ç° `getUserRole()` æ–¹æ³•
    - [ ] å®ç° `updateUserRole()` æ–¹æ³•
    - [ ] å®ç° `getStudentList()` æ–¹æ³•
    - [ ] å®ç° `addStudentRelation()` æ–¹æ³•
    - [ ] å®ç° `removeStudentRelation()` æ–¹æ³•
    - [ ] å®ç° `getStudentProgress()` æ–¹æ³•
    - [ ] å®ç° `getStudentExerciseRecords()` æ–¹æ³•
    - [ ] å®ç° `getStudentGameRecords()` æ–¹æ³•
    - [ ] å®ç°/æ›´æ–° `updatePracticePlayRatio(studentId, practiceMinutes, playMinutes, maxDailyMinutes?)`ï¼ˆå®¶é•¿é…ç½®ç»ƒä¹ â†’æ¸¸æˆæ¯”ä¾‹ï¼‰
    - [ ] å®ç° `getPracticePlayRatio(studentId)`ï¼ˆç”¨äºæ¸¸æˆæ—¶é•¿è®¡ç®—ï¼‰

35. **åˆ›å»º parent.ts Storeï¼ˆå¯é€‰ï¼‰**
    - [ ] åˆ›å»º `src/stores/parent.ts`
    - [ ] å®ç°å®¶é•¿ç›¸å…³çŠ¶æ€ç®¡ç†

---

#### æ¨¡å— 9: èµ„æºæ¨¡å—

36. **åˆ›å»ºèµ„æºæ¨¡å—æ•°æ®åº“è¡¨**
    - [ ] åˆ›å»º `pronunciation_resources` è¡¨
    - [ ] åˆ›å»º `word_resources` è¡¨
    - [ ] åˆ›å»º `sentence_resources` è¡¨
    - [ ] åˆ›å»º `textbook_resources` è¡¨ï¼ˆæœªæ¥ï¼‰
    - [ ] åˆ›å»º `pronunciation_records` è¡¨ï¼ˆå¯é€‰ï¼‰
    - [ ] åˆ›å»ºç´¢å¼•

37. **é…ç½®èµ„æºæ¨¡å— RLS**
    - [ ] ä¸ºèµ„æºè¡¨å¯ç”¨ RLSï¼ˆç³»ç»Ÿèµ„æºæ‰€æœ‰ç”¨æˆ·å¯è¯»ï¼‰
    - [ ] ä¸º `pronunciation_records` è¡¨å¯ç”¨ RLS
    - [ ] åˆ›å»º RLS ç­–ç•¥

38. **æ‰©å±•ç”¨æˆ·æ¨¡å—è¡¨ç»“æ„ï¼ˆå‘éŸ³è®¾ç½®ï¼‰**
    - [ ] åœ¨ `user_profiles` è¡¨æ·»åŠ å‘éŸ³è®¾ç½®å­—æ®µ
    - [ ] æ·»åŠ  `pronunciation_enabled`
    - [ ] æ·»åŠ  `pronunciation_volume`
    - [ ] æ·»åŠ  `letter_pronunciation_enabled`
    - [ ] æ·»åŠ  `word_pronunciation_enabled`
    - [ ] æ·»åŠ  `sentence_pronunciation_enabled`

39. **åˆ›å»ºèµ„æºæ¨¡å— API æœåŠ¡**
    - [ ] åˆ›å»º `src/services/api/resource.api.ts`
    - [ ] å®ç° `getPronunciationSettings()` æ–¹æ³•
    - [ ] å®ç° `updatePronunciationSettings()` æ–¹æ³•
    - [ ] å®ç° `getLetterPronunciation()` æ–¹æ³•
    - [ ] å®ç° `getWordPronunciation()` æ–¹æ³•
    - [ ] å®ç° `getSentencePronunciation()` æ–¹æ³•
    - [ ] å®ç° `getWordResource()` æ–¹æ³•
    - [ ] å®ç° `getSentenceResource()` æ–¹æ³•
    - [ ] å®ç° `getTextbookResources()` æ–¹æ³•ï¼ˆæœªæ¥ï¼‰
    - [ ] å®ç° `recordPronunciationUsage()` æ–¹æ³•ï¼ˆå¯é€‰ï¼‰
    - [ ] å®ç° `getPronunciationStats()` æ–¹æ³•ï¼ˆå¯é€‰ï¼‰

40. **é…ç½® Supabase Storage**
    - [ ] åˆ›å»º `resources` bucket
    - [ ] é…ç½®å­˜å‚¨ç­–ç•¥
    - [ ] ä¸Šä¼ åˆå§‹èµ„æºæ–‡ä»¶ï¼ˆå¯é€‰ï¼‰

41. **åˆ›å»º resource.ts Storeï¼ˆå¯é€‰ï¼‰**
    - [ ] åˆ›å»º `src/stores/resource.ts`
    - [ ] å®ç°èµ„æºç¼“å­˜ç®¡ç†

---

### è·¨æ¨¡å—åŠŸèƒ½

#### æ•°æ®åŒæ­¥æœåŠ¡

42. **åˆ›å»ºæ•°æ®åŒæ­¥æœåŠ¡**
    - [ ] åˆ›å»º `src/services/sync/sync.service.ts`
    - [ ] å®ç° `syncToCloud()` æ–¹æ³•
    - [ ] å®ç° `syncFromCloud()` æ–¹æ³•
    - [ ] å®ç°å†²çªæ£€æµ‹é€»è¾‘
    - [ ] å®ç°å†²çªè§£å†³ç­–ç•¥

43. **åˆ›å»ºæ•°æ®è¿ç§»æœåŠ¡**
    - [ ] åˆ›å»º `src/services/sync/migration.service.ts`
    - [ ] å®ç° `detectOldData()` æ–¹æ³•
    - [ ] å®ç° `migrateData()` æ–¹æ³•
    - [ ] å®ç°æ•°æ®éªŒè¯é€»è¾‘
    - [ ] åˆ›å»ºè¿ç§» UI ç»„ä»¶

---

### æµ‹è¯•å’Œä¼˜åŒ–

44. **ç«¯åˆ°ç«¯æµ‹è¯•**
    - [ ] æµ‹è¯•åŸºç¡€è®¾æ–½æ¨¡å—ï¼ˆè®¤è¯æµç¨‹ï¼‰
    - [ ] æµ‹è¯•ç”¨æˆ·æ¨¡å—ï¼ˆèµ„æ–™ã€è¿›åº¦åŒæ­¥ï¼‰
    - [ ] æµ‹è¯•ç»ƒä¹ æ¨¡å—ï¼ˆè®°å½•åŒæ­¥ï¼‰
    - [ ] æµ‹è¯•æ¸¸æˆæ¨¡å—ï¼ˆè®°å½•åŒæ­¥ï¼‰
    - [ ] æµ‹è¯•ç§¯åˆ†æ¨¡å—ï¼ˆç§¯åˆ†ç®¡ç†ï¼‰
    - [ ] æµ‹è¯•ç¤¼ç‰©æ¨¡å—ï¼ˆå…‘æ¢æµç¨‹ï¼‰
    - [ ] æµ‹è¯•æˆå°±æ¨¡å—ï¼ˆè§£é”æµç¨‹ï¼‰
    - [ ] æµ‹è¯•å®¶é•¿æ¨¡å—ï¼ˆå…³è”ã€æŸ¥çœ‹å­¦ç”Ÿæ•°æ®ï¼‰
    - [ ] æµ‹è¯•èµ„æºæ¨¡å—ï¼ˆå‘éŸ³ã€èµ„æºè·å–ï¼‰
    - [ ] æµ‹è¯•ç¦»çº¿æ¨¡å¼
    - [ ] æµ‹è¯•æ•°æ®è¿ç§»æµç¨‹
    - [ ] æµ‹è¯• RLS ç­–ç•¥ï¼ˆç¡®ä¿æ•°æ®éš”ç¦»ï¼‰

45. **æ€§èƒ½ä¼˜åŒ–**
    - [ ] ä¼˜åŒ–æ‰¹é‡æ“ä½œ
    - [ ] å®ç°å¢é‡åŒæ­¥
    - [ ] ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
    - [ ] æ·»åŠ æœ¬åœ°ç¼“å­˜ç­–ç•¥

46. **é”™è¯¯å¤„ç†å®Œå–„**
    - [ ] æ·»åŠ å…¨å±€é”™è¯¯å¤„ç†
    - [ ] æ·»åŠ ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
    - [ ] æ·»åŠ é”™è¯¯æ—¥å¿—è®°å½•
    - [ ] å¤„ç†ç½‘ç»œé”™è¯¯åœºæ™¯

47. **æ–‡æ¡£æ›´æ–°**
    - [ ] æ›´æ–° README.mdï¼ˆæ·»åŠ  Supabase é…ç½®è¯´æ˜ï¼‰
    - [ ] åˆ›å»ºæ•°æ®åº“è¿ç§»æ–‡æ¡£
    - [ ] åˆ›å»º API æœåŠ¡ä½¿ç”¨æ–‡æ¡£ï¼ˆæŒ‰æ¨¡å—ï¼‰
    - [ ] æ›´æ–°é¡¹ç›®æ–‡æ¡£

---

## Validation

- [ ] è¿è¡Œ `openspec validate integrate-supabase-backend --strict`
- [ ] ä¿®å¤æ‰€æœ‰éªŒè¯é”™è¯¯
- [ ] ç¡®ä¿æ‰€æœ‰ä»»åŠ¡å¯éªŒè¯å’Œå¯æµ‹è¯•
