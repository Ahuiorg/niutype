# æŠ€æœ¯è®¾è®¡æ–‡æ¡£

## Context

### èƒŒæ™¯
ä¸º7å²å„¿ç«¥è®¾è®¡çš„æ‰“å­—ç»ƒä¹ ç½‘ç«™ï¼Œç›®æ ‡æ˜¯å¸®åŠ©å…¶ç†Ÿæ‚‰æ ‡å‡†é”®ç›˜ä¸Š26ä¸ªå­—æ¯çš„ä½ç½®ï¼Œå»ºç«‹æ­£ç¡®çš„æ‰“å­—æ‰‹æŒ‡ä¹ æƒ¯ã€‚

### çº¦æŸ
- çº¯å‰ç«¯åº”ç”¨ï¼Œæ— åŽç«¯æœåŠ¡
- æ•°æ®æŒä¹…åŒ–ä¾èµ– localStorage
- ç›®æ ‡ç”¨æˆ·ä¸ºå„¿ç«¥ï¼Œç•Œé¢éœ€è¦ç®€æ´å‹å¥½
- éœ€è¦å®¶é•¿èƒ½å¤Ÿè®¾ç½®ç§¯åˆ†å…‘æ¢çš„ç¤¼ç‰©

### åˆ©ç›Šç›¸å…³è€…
- ä¸»è¦ç”¨æˆ·ï¼š7å²å„¿ç«¥
- æ¬¡è¦ç”¨æˆ·ï¼šå®¶é•¿ï¼ˆè®¾ç½®ç¤¼ç‰©ã€æŸ¥çœ‹è¿›åº¦ï¼‰

## Goals / Non-Goals

### Goals
- å¸®åŠ©å„¿ç«¥åœ¨çº¦1ä¸ªæœˆå†…ç†Ÿæ‚‰æ‰€æœ‰å­—æ¯é”®ä½
- é€šè¿‡æ¸¸æˆåŒ–å…ƒç´ ä¿æŒå­¦ä¹ å…´è¶£
- æä¾›æ¸…æ™°çš„æ‰‹æŒ‡ä½ç½®æŒ‡å¯¼
- æ™ºèƒ½è¯†åˆ«å¼±é¡¹å¹¶é’ˆå¯¹æ€§å¼ºåŒ–
- ç®€å•æ˜“ç”¨ï¼Œå„¿ç«¥å¯ç‹¬ç«‹æ“ä½œ

### Non-Goals
- ä¸è¿½æ±‚ä¸“ä¸šæ‰“å­—é€Ÿåº¦è®­ç»ƒ
- ä¸æ¶‰åŠæ•°å­—å’Œç‰¹æ®Šå­—ç¬¦
- ä¸éœ€è¦ç”¨æˆ·æ³¨å†Œ/ç™»å½•ç³»ç»Ÿ
- ä¸éœ€è¦å¤šç”¨æˆ·æ”¯æŒï¼ˆå•æœºå•ç”¨æˆ·ï¼‰
- ä¸éœ€è¦åŽç«¯æœåŠ¡

## Decisions

### 1. æŠ€æœ¯æ ˆé€‰æ‹©
- **Decision**: Vue3 + TypeScript + Pinia + NaiveUI + Vite
- **Why**: 
  - Vue3 Composition API é€‚åˆçŠ¶æ€ç®¡ç†
  - TypeScript æä¾›ç±»åž‹å®‰å…¨
  - Pinia è½»é‡çº§çŠ¶æ€ç®¡ç†ï¼Œæ”¯æŒæŒä¹…åŒ–æ’ä»¶
  - NaiveUI æä¾›ç¾Žè§‚çš„ç»„ä»¶åº“
  - Vite å¿«é€Ÿå¼€å‘ä½“éªŒ
- **Alternatives**: React + Zustandï¼ˆç†Ÿæ‚‰åº¦è€ƒè™‘é€‰æ‹© Vueï¼‰

### 2. æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆ
- **Decision**: localStorage + pinia-plugin-persistedstate
- **Why**: 
  - æ— éœ€åŽç«¯ï¼Œç®€å•å¯é 
  - æ’ä»¶è‡ªåŠ¨å¤„ç†åºåˆ—åŒ–/ååºåˆ—åŒ–
  - æ”¯æŒé€‰æ‹©æ€§æŒä¹…åŒ–
- **Data Structure**:
```typescript
interface UserData {
  currentDay: number;           // å½“å‰è§£é”çš„å¤©æ•°
  todayProgress: {
    startTime: number | null;   // ä»Šæ—¥å¼€å§‹æ—¶é—´
    totalTime: number;          // ä»Šæ—¥ç´¯è®¡æ—¶é—´(ms)
    completed: boolean;         // ä»Šæ—¥æ˜¯å¦å®Œæˆ
  };
  totalPoints: number;          // æ€»ç§¯åˆ†
  usedPoints: number;           // å·²ä½¿ç”¨ç§¯åˆ†
  gifts: Gift[];                // å¯å…‘æ¢ç¤¼ç‰©åˆ—è¡¨
  redeemedGifts: RedeemedGift[]; // å·²å…‘æ¢ç¤¼ç‰©
  achievements: Achievement[];   // å·²èŽ·å¾—æˆå°±
  letterStats: {                // æ¯ä¸ªå­—æ¯çš„ç»Ÿè®¡
    [letter: string]: {
      totalAttempts: number;
      correctAttempts: number;
      avgResponseTime: number;  // å¹³å‡ååº”æ—¶é—´(ms)
    }
  };
  dailyRecords: DailyRecord[];  // æ¯æ—¥è®°å½•
}
```

### 3. éš¾åº¦é€’è¿›è®¾è®¡
- **Decision**: 4é˜¶æ®µæ¸è¿›å¼è®¾è®¡
- **Why**: å¹³è¡¡å­¦ä¹ æ•ˆæžœå’Œè¶£å‘³æ€§

| é˜¶æ®µ | å¤©æ•° | å†…å®¹ | è¯´æ˜Ž |
|------|------|------|------|
| é˜¶æ®µ1ï¼šå•æŒ‡åŸºç¡€ | 1-8å¤© | æ¯å¤©ä¸“æ³¨1-2ä¸ªæ‰‹æŒ‡çš„é”®ä½ | å·¦æ‰‹å°æŒ‡â†’å³æ‰‹å°æŒ‡ï¼Œé€ä¸ªæ‰‹æŒ‡ç»ƒä¹  |
| é˜¶æ®µ2ï¼šåŒæ‰‹ç»„åˆ | 9-14å¤© | åŒä¸€åªæ‰‹çš„å¤šæŒ‡é…åˆ | å¦‚ ASDFã€JKL; ç­‰ |
| é˜¶æ®µ3ï¼šåŒæ‰‹åä½œ | 15-21å¤© | å·¦å³æ‰‹äº¤æ›¿é…åˆ | è·¨æ‰‹é”®ä½ç»„åˆ |
| é˜¶æ®µ4ï¼šç»¼åˆå¼ºåŒ– | 22å¤©+ | éšæœºå­—æ¯ + å¼±é¡¹å¼ºåŒ– | æ ¹æ®ç»Ÿè®¡åŠ¨æ€ç”Ÿæˆ |

### 4. æ‰‹æŒ‡é”®ä½åˆ†é…ï¼ˆæ ‡å‡†æ‰“å­—æ³•ï¼‰
```
å·¦æ‰‹å°æŒ‡: Q A Z
å·¦æ‰‹æ— åæŒ‡: W S X
å·¦æ‰‹ä¸­æŒ‡: E D C
å·¦æ‰‹é£ŸæŒ‡: R F V T G B
å³æ‰‹é£ŸæŒ‡: Y H N U J M
å³æ‰‹ä¸­æŒ‡: I K ,
å³æ‰‹æ— åæŒ‡: O L .
å³æ‰‹å°æŒ‡: P ; /
```

### 5. ç»ƒä¹ å†…å®¹ç”Ÿæˆç®—æ³•
- **Decision**: æ··åˆç­–ç•¥
```typescript
function generateExercise(day: number, letterStats: LetterStats): Exercise {
  const stage = getStage(day);
  const targetLetters = getTargetLetters(stage, day);
  const weakLetters = getWeakLetters(letterStats, targetLetters);
  
  // 70% å½“æ—¥ç›®æ ‡å­—æ¯ï¼Œ30% å¼±é¡¹å¼ºåŒ–
  const exercises = [];
  exercises.push(...generateFromLetters(targetLetters, 0.7));
  exercises.push(...generateFromLetters(weakLetters, 0.3));
  
  return shuffle(exercises);
}
```

### 6. ç§¯åˆ†ç³»ç»Ÿè®¾è®¡
- **Decision**: åŸºäºŽè¡¨çŽ°çš„ç§¯åˆ†è®¡ç®—
```typescript
// åŸºç¡€ç§¯åˆ†
const BASE_DAILY_POINTS = 100;  // å®Œæˆæ¯æ—¥ä»»åŠ¡åŸºç¡€åˆ†

// åŠ æˆè®¡ç®—
const accuracyBonus = accuracy >= 0.95 ? 50 : accuracy >= 0.9 ? 30 : accuracy >= 0.8 ? 10 : 0;
const speedBonus = avgTime <= 500 ? 30 : avgTime <= 800 ? 15 : 0;
const streakBonus = consecutiveDays * 10;  // è¿žç»­æ‰“å¡åŠ æˆ

const totalPoints = BASE_DAILY_POINTS + accuracyBonus + speedBonus + streakBonus;
```

### 7. æˆå°±ç³»ç»Ÿè®¾è®¡
- **Decision**: å¤šç»´åº¦æˆå°±æ¿€åŠ±
```typescript
const achievements = [
  // åšæŒç±»
  { id: 'first_day', name: 'åˆæ¬¡å°è¯•', desc: 'å®Œæˆç¬¬ä¸€å¤©ç»ƒä¹ ', icon: 'ðŸŒŸ' },
  { id: 'week_streak', name: 'ä¸€å‘¨åšæŒ', desc: 'è¿žç»­ç»ƒä¹ 7å¤©', icon: 'ðŸ”¥' },
  { id: 'month_master', name: 'æœˆåº¦è¾¾äºº', desc: 'è¿žç»­ç»ƒä¹ 30å¤©', icon: 'ðŸ‘‘' },
  
  // å‡†ç¡®çŽ‡ç±»
  { id: 'perfect_day', name: 'å®Œç¾Žä¸€å¤©', desc: 'å•æ—¥å‡†ç¡®çŽ‡100%', icon: 'ðŸ’¯' },
  { id: 'accuracy_master', name: 'ç²¾å‡†å¤§å¸ˆ', desc: 'ç´¯è®¡å‡†ç¡®çŽ‡95%+', icon: 'ðŸŽ¯' },
  
  // é€Ÿåº¦ç±»
  { id: 'speed_demon', name: 'é—ªç”µæ‰‹æŒ‡', desc: 'å¹³å‡ååº”æ—¶é—´<500ms', icon: 'âš¡' },
  
  // é‡Œç¨‹ç¢‘ç±»
  { id: 'thousand_chars', name: 'åƒå­—è¾¾äºº', desc: 'ç´¯è®¡è¾“å…¥1000ä¸ªå­—ç¬¦', icon: 'ðŸ“' },
  { id: 'ten_thousand', name: 'ä¸‡å­—å¤§å¸ˆ', desc: 'ç´¯è®¡è¾“å…¥10000ä¸ªå­—ç¬¦', icon: 'ðŸ“š' },
];
```

### 8. UI/UX è®¾è®¡åŽŸåˆ™
- **Decision**: å„¿ç«¥å‹å¥½çš„æ¸¸æˆåŒ–ç•Œé¢
- **Color Scheme**: æ˜Žäº®æ´»æ³¼ï¼Œé¿å…åˆºçœ¼
  - ä¸»è‰²ï¼šæ¸©æš–çš„æ©™è‰² #FF9500
  - è¾…åŠ©ï¼šæŸ”å’Œçš„è“è‰² #4A90D9
  - æˆåŠŸï¼šç¿ ç»¿è‰² #34C759
  - é”™è¯¯ï¼šæŸ”å’Œçº¢è‰² #FF6B6B
- **Typography**: åœ†æ¶¦æ˜“è¯»çš„å­—ä½“
- **Animations**: é€‚åº¦çš„åŠ¨ç”»åé¦ˆï¼ˆæŒ‰é”®ã€æˆå°±è§£é”ï¼‰
- **Sound**: å¯é€‰çš„éŸ³æ•ˆåé¦ˆï¼ˆæ­£ç¡®/é”™è¯¯/æˆå°±ï¼‰

## Component Architecture

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ keyboard/
â”‚   â”‚   â”œâ”€â”€ VirtualKeyboard.vue    # è™šæ‹Ÿé”®ç›˜ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ KeyboardKey.vue        # å•ä¸ªæŒ‰é”®
â”‚   â”‚   â””â”€â”€ FingerGuide.vue        # æ‰‹æŒ‡æŒ‡ç¤º
â”‚   â”œâ”€â”€ exercise/
â”‚   â”‚   â”œâ”€â”€ TypingArea.vue         # æ‰“å­—ç»ƒä¹ åŒº
â”‚   â”‚   â”œâ”€â”€ CharacterDisplay.vue   # å½“å‰å­—ç¬¦æ˜¾ç¤º
â”‚   â”‚   â””â”€â”€ ProgressBar.vue        # è¿›åº¦æ¡
â”‚   â”œâ”€â”€ stats/
â”‚   â”‚   â”œâ”€â”€ DailyStats.vue         # æ¯æ—¥ç»Ÿè®¡
â”‚   â”‚   â”œâ”€â”€ LetterAccuracy.vue     # å­—æ¯å‡†ç¡®çŽ‡
â”‚   â”‚   â””â”€â”€ WeakLetterChart.vue    # å¼±é¡¹å›¾è¡¨
â”‚   â”œâ”€â”€ rewards/
â”‚   â”‚   â”œâ”€â”€ PointsDisplay.vue      # ç§¯åˆ†æ˜¾ç¤º
â”‚   â”‚   â”œâ”€â”€ AchievementCard.vue    # æˆå°±å¡ç‰‡
â”‚   â”‚   â””â”€â”€ GiftCard.vue           # ç¤¼ç‰©å¡ç‰‡
â”‚   â””â”€â”€ common/
â”‚       â”œâ”€â”€ Timer.vue              # è®¡æ—¶å™¨
â”‚       â””â”€â”€ Modal.vue              # å¼¹çª—
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ HomePage.vue               # é¦–é¡µï¼ˆå¼€å§‹ç»ƒä¹ å…¥å£ï¼‰
â”‚   â”œâ”€â”€ ExercisePage.vue           # ç»ƒä¹ é¡µé¢
â”‚   â”œâ”€â”€ StatsPage.vue              # ç»Ÿè®¡é¡µé¢
â”‚   â”œâ”€â”€ AchievementsPage.vue       # æˆå°±é¡µé¢
â”‚   â””â”€â”€ GiftShopPage.vue           # ç¤¼ç‰©å…‘æ¢é¡µé¢
â”œâ”€â”€ stores/
â”‚   â”œâ”€â”€ user.ts                    # ç”¨æˆ·æ•°æ®
â”‚   â”œâ”€â”€ exercise.ts                # ç»ƒä¹ çŠ¶æ€
â”‚   â””â”€â”€ achievements.ts            # æˆå°±ç³»ç»Ÿ
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ exerciseGenerator.ts       # ç»ƒä¹ ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ fingerMapping.ts           # æ‰‹æŒ‡æ˜ å°„
â”‚   â””â”€â”€ pointsCalculator.ts        # ç§¯åˆ†è®¡ç®—
â””â”€â”€ types/
    â””â”€â”€ index.ts                   # TypeScript ç±»åž‹å®šä¹‰
```

## Risks / Trade-offs

| é£Žé™© | å½±å“ | ç¼“è§£æŽªæ–½ |
|------|------|----------|
| localStorage æ•°æ®ä¸¢å¤± | è¿›åº¦ä¸¢å¤± | æä¾›æ•°æ®å¯¼å‡º/å¯¼å…¥åŠŸèƒ½ |
| 30åˆ†é’Ÿå¯¹å„¿ç«¥å¤ªé•¿ | ç–²åŠ³ã€å¤±åŽ»å…´è¶£ | åˆ†æ®µè®¾è®¡ï¼Œæ¯5åˆ†é’Ÿä¼‘æ¯æç¤º |
| éš¾åº¦è®¾è®¡ä¸åˆç† | å¤ªéš¾æˆ–å¤ªç®€å• | å¯é…ç½®çš„éš¾åº¦å‚æ•°ï¼ŒåŽç»­å¯è°ƒæ•´ |
| é”®ç›˜å¸ƒå±€ä¸åŒ | QWERTYä»¥å¤–çš„é”®ç›˜ | ä»…æ”¯æŒ QWERTYï¼Œåœ¨è¯´æ˜Žä¸­æ³¨æ˜Ž |

## Open Questions

1. ~~æ˜¯å¦éœ€è¦å®¶é•¿æ¨¡å¼/å¯†ç ä¿æŠ¤ç¤¼ç‰©è®¾ç½®ï¼Ÿ~~ â†’ æš‚ä¸éœ€è¦ï¼Œä¿æŒç®€å•
2. æ˜¯å¦éœ€è¦éŸ³æ•ˆï¼Ÿ â†’ å¯é€‰åŠŸèƒ½ï¼Œé»˜è®¤å¼€å¯
3. æ˜¯å¦æ”¯æŒç§»åŠ¨ç«¯ï¼Ÿ â†’ é¦–æœŸä»…æ”¯æŒæ¡Œé¢ç«¯ï¼ˆéœ€è¦ç‰©ç†é”®ç›˜ï¼‰

